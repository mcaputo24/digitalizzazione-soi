<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digitalizzazione SOI - Questionario</title>
    <link rel="stylesheet" href="style.css">

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js"></script>
</head>
<body>
    <header>
        <img src="logo.png" alt="Logo Sviluppo Lavoro Italia">
        <h1>Sistema di Orientamento Integrato</h1>
    </header>

<main>
  <!-- HOME-VIEW -->
  <div id="home-view" class="view">
    <div class="choice-box">
      <h2>Seleziona il percorso che vuoi iniziare:</h2>
      <a href="#/studente/fase1-anno1" class="choice-button">
        Fase 1 – Rilevazione bisogni di orientamento anno I
      </a>
      <a href="#/studente/fase1-anno2" class="choice-button">
        Fase 1 – Rilevazione bisogni di orientamento anno II
      </a>
      <a href="#/studente/fase1-anno3" class="choice-button">
        Fase 1 – Rilevazione bisogni di orientamento anno III
      </a>
      <a href="#/studente/fase3-anno1" class="choice-button">
        Fase 3 – Sintesi dell’esperienza anno I
      </a>
      <a href="#/studente/fase3-anno2" class="choice-button">
        Fase 3 – Sintesi dell’esperienza anno II
      </a>
      <a href="#/studente/fase3-anno3" class="choice-button">
        Fase 3 – Sintesi dell’esperienza anno III
      </a>
      <a href="#/studente/fase4" class="choice-button">
        Fase 4 – Rielaborazione dell’esperienza
      </a>
      <a href="#/docente" class="choice-button">
        Accesso Docenti
      </a>
    </div>
  </div>

  <!-- FORM CONTAINER (generato da JS) -->
  <div id="form-container"></div>
</main>

        <div id="dashboard-view" class="view" style="display: none;">
            <div class="dashboard-header">
                <h2>Dashboard Docente</h2>
                <div class="dashboard-actions">
                    <button id="show-fase1-btn" class="action-btn">Compila Fase 1 (Griglia di Osservazione della Classe)</button>
                    <button id="show-fase3-btn" class="action-btn">Compila Fase 3 (Scheda di Sintesi Generale)</button>
                </div>
                <button id="logout-btn" class="logout-btn">Esci</button>
            </div>
            <div id="student-list-container"></div>
        </div>
<!-- Vista dettaglio studente -->
    <div id="student-detail-view" class="view" style="display: none;">
        <div class="detail-header">
            <a href="#/docente/dashboard" class="back-link">&larr; Torna alla Dashboard</a>
            <h2 id="student-name-title">Dettaglio Studente</h2>
        </div>
        <div class="dashboard-actions">
            <button id="show-fase2-btn" class="action-btn">Compila Fase 2 (Sintesi Individuale)</button>
        </div>
        <div id="student-detail-content"></div>
    </div>
<div id="modal-container" class="modal-container" style="display: none;">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <div id="modal-body">
                </div>
        </div>
    </div>
    <script>
      // Configurazione di Firebase (come da te fornita)
      const firebaseConfig = {
        apiKey: "AIzaSyD05kBg5aIs663s6Ma9abLj6_vmh9O_R9k",
        authDomain: "digitalizzazione-soi.firebaseapp.com",
        projectId: "digitalizzazione-soi",
        storageBucket: "digitalizzazione-soi.firebasestorage.app",
        messagingSenderId: "619321139714",
        appId: "1:619321139714:web:d223ced5217cabcd49bd1b"
      };
      // Inizializza Firebase
      firebase.initializeApp(firebaseConfig);
    </script>
<!-- 1) la configurazione dei form -->
<script src="forms-config.js"></script>
<!-- 2) il renderer che crea il markup -->
<script src="form-renderer.js"></script>
<script>
  function hideAllViews() {
    // nasconde tutte le .view e il form-container
    document.querySelectorAll('.view').forEach(v => v.style.display = 'none');
    document.getElementById('form-container').style.display = 'none';
  }

  function onHashChange() {
    hideAllViews();

    const h = location.hash;
    if (!h || h === '#') {
      // nessun hash → mostro la home-view
      document.getElementById('home-view').style.display = 'block';
    }
    else if (h.includes('fase1-anno1')) {
      // Fase 1 anno 1
      document.getElementById('form-container').style.display = 'block';
      renderForm('#form-container', formsConfig.fase1.anno1.schede);
    }
    else if (h.includes('fase1-anno2')) {
      // Fase 1 anno 2
      document.getElementById('form-container').style.display = 'block';
      renderForm('#form-container', formsConfig.fase1.anno2.schede);
    }
    // … aggiungi qui fase3, fase4, docente, ecc. …
  }

  window.addEventListener('hashchange', onHashChange);
  onHashChange(); // al caricamento della pagina
</script>
<!-- 3) il piccolo router hash-based -->
<script>
  function onHashChange() {
    const hash = location.hash;
    if (hash.includes('fase1-anno1')) {
      renderForm('#form-container', formsConfig.fase1.anno1.schede);
    } else if (hash.includes('fase1-anno2')) {
      renderForm('#form-container', formsConfig.fase1.anno2.schede);
    }
    // … poi fase3, fase4 …
  }
  window.addEventListener('hashchange', onHashChange);
  onHashChange(); // al caricamento
</script>
<!-- 4) il tuo script principale (Firebase, salvataggi, ecc.) -->
<script src="script.js"></script>
</body>
</html>
